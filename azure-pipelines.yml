# ============================================================
# Pipeline with explicit dependency stages + diagnostics
# ============================================================

stages:

# -------------------------------
# Stage 0: C
# -------------------------------
- stage: C
  displayName: "C"
  jobs:
    - job: job_C
      displayName: "Execute Job-C"
      pool:
        name: 'test-windows-vm'
      steps:
        - script: |
            echo "C completed..."
            echo "Job C completed..."


# -------------------------------
# Stage 1: B (depends on failed build; will be skipped)
# -------------------------------
- stage: B
  displayName: "B"
  dependsOn:
    - C
  condition: succeeded()   
  jobs:
    - job: job_B
      displayName: "Execute Job-B"
      pool:
        name: 'test-windows-vm'
      steps:
        # Diagnostics for dependency results visible to this stage
        - script: |
            echo "B completed..."
            echo "Job B completed..."


# -------------------------------
# Stage 2: A (deps failed/skipped; will be skipped)
# -------------------------------
- stage: A
  displayName: "A"
  dependsOn:
    - B

  # Only run when all dependencies succeeded (or succeeded with issues)
  condition: succeeded()

  jobs:
    - job: job_A
      displayName: "Execute job-A"
      pool:
        name: 'test-windows-vm'
      steps:
        # ------------------------------------------------------------
        # Diagnostics: echo dependency results for quick visibility
        # ------------------------------------------------------------
        - script: |
            echo "A completed..."
            echo "Job A completed..."
